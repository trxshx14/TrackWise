{% extends 'base.html' %}
{% load static %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/inventory.css' %}">
<link rel="stylesheet" href="{% static 'css/inventory/product_delete.css' %}">
{% endblock %}

{% block title %}Delete Product - TrackWise{% endblock %}

{% block content %}
<div class="auth-body">
    <div class="auth-container product-delete-container">
        <div class="logo-container">
            <div class="logo-text">
                <i class="fas fa-chart-line"></i>
                TrackWise
            </div>
        </div>
        
        <div class="form-section product-delete-section">
            <div class="auth-header">
                <h2>Delete Product</h2>
                <p>Confirm product deletion</p>
            </div>

            {% comment %} {% if messages %}
                {% for message in messages %}
                    <div class="alert alert-{{ message.tags }}">
                        {{ message }}
                    </div>
                {% endfor %}
            {% endif %} {% endcomment %}
            
            <div class="warning-section">
                <div class="warning-icon">
                    <i class="fas fa-exclamation-triangle"></i>
                </div>
                
                <h3 class="warning-title">Confirm Deletion</h3>
                <p class="warning-text">Are you sure you want to delete <strong>"{{ product.item_name }}"</strong>?</p>
                <p class="warning-subtext">This action cannot be undone and all product data will be permanently lost.</p>
                
                {% if product.quantity > 0 %}
                <div class="quantity-warning">
                    <i class="fas fa-info-circle"></i>
                    <span>This product currently has {{ product.quantity }} units in stock.</span>
                </div>
                {% endif %}
            </div>
            
            <form method="post" id="delete-form">
                {% csrf_token %}
                
                <div class="button-group delete-buttons">
                    <button type="submit" class="btn btn-danger btn-delete">
                        <i class="fas fa-trash"></i> Yes, Delete Product
                    </button>
                    <a href="{% url 'inventory:inventory_list' %}" class="btn btn-secondary">
                        <i class="fas fa-times"></i> Cancel
                    </a>
                </div>
            </form>
            
            <div class="auth-footer">
                <p class="footer-content">
                    <a href="{% url 'inventory:inventory_list' %}" class="footer-home-link">
                        <i class="fas fa-arrow-left"></i> Back to Inventory
                    </a>
                    <a>|</a>
                    <span class="footer-spacer"></span>
                    <a href="#" class="footer-support-link">Contact Support</a>
                </p>
            </div>
        </div>

        <div class="particles-section product-delete-particles" id="particles-js"></div>
    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/particles.js/2.0.0/particles.min.js"></script>
<script>
    // Particles configuration with warning theme
    particlesJS('particles-js', {
        particles: {
            number: { value: 50, density: { enable: true, value_area: 500 } },
            color: { value: '#ff6b6b' }, // Warning red color
            shape: { type: 'circle' },
            opacity: { value: 0.8, random: true },
            size: { value: 18, random: true },
            line_linked: {
                enable: true,
                distance: 130,
                color: '#ff6b6b',
                opacity: 0.6,
                width: 2
            },
            move: {
                enable: true,
                speed: 1.3,
                direction: 'none',
                random: true,
                out_mode: 'out'
            }
        },
        interactivity: {
            detect_on: 'canvas',
            events: {
                onhover: { enable: true, mode: 'repulse' }, // Repulse on hover for warning effect
                resize: true
            },
            modes: {
                repulse: { distance: 120, duration: 0.4 }
            }
        },
        retina_detect: true
    });

    // Add confirmation for delete button
    const deleteForm = document.getElementById('delete-form');
    const deleteButton = document.querySelector('.btn-delete');

    deleteButton.addEventListener('click', function(e) {
        const productName = "{{ product.item_name }}";
        const confirmation = confirm(`Are you absolutely sure you want to delete "${productName}"? This action cannot be undone.`);
        
        if (!confirmation) {
            e.preventDefault();
        }
    });

    // Double confirmation for extra safety
    deleteForm.addEventListener('submit', function(e) {
        const productName = "{{ product.item_name }}";
        const finalConfirmation = confirm(`FINAL WARNING: You are about to permanently delete "${productName}". This will remove all product data from the system. Click OK to proceed or Cancel to abort.`);
        
        if (!finalConfirmation) {
            e.preventDefault();
        }
    });
</script>
{% endblock %}